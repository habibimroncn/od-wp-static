import{g as t,a as i,r as s,h as e,c as h,w as a,H as n}from"./p-811c9fd4.js";import{e as r,i as o,s as l,a as c,b as u}from"./p-3bfefa6f.js";import{d,f as v,c as m,l as y,a as p,h as b,b as g,e as f,j as k}from"./p-f021dfd0.js";import{w as C,g as w}from"./p-f3727652.js";import{V as P,M as T}from"./p-8904db17.js";import{c as S,a as E,b as j,o as V,d as M,e as R}from"./p-8ffe7be8.js";import{d as x,a as F,b as A,c as O}from"./p-dbd3a850.js";import{P as I}from"./p-7afe5dc8.js";import{a as $,w as L,c as _}from"./p-5d182d13.js";import{a as z,d as Q,h as D,b as q}from"./p-b0ea4d0d.js";import{D as B}from"./p-874fa941.js";var H=new Map,U=function(t,i){var s=t.updater;t.fields.forEach((function(t){s(t,i[t])}))},W=function(t,s){var e=t.state,h=i();if(H.has(h)){var a=H.get(h);a.state=e,a.wormholes.forEach((function(t){U(t,e)}))}return s};const N=class{constructor(t){s(this,t),this.willAttach=!1,this.preload="metadata",this.willAttach||$(this)}async getAdapter(){const t=await this.fileProvider.getAdapter();return t.canPlay=async t=>d(t)&&z.test(t),t}render(){return e("vime-file",{noConnect:!0,willAttach:this.willAttach,crossOrigin:this.crossOrigin,preload:this.preload,disableRemotePlayback:this.disableRemotePlayback,mediaTitle:this.mediaTitle,viewType:P.Audio,ref:t=>{this.fileProvider=t}},e("slot",null))}},Y=()=>{let t,i;return{promise:new Promise(((s,e)=>{t=s,i=e})),resolve:t,reject:i}},G=new Map,J=class{constructor(t){s(this,t),this.vLoadStart=h(this,"vLoadStart",7),this.defaultInternalState={},this.internalState={currentTime:0,volume:0,muted:!1,isAdsPlaying:!1,playbackReady:!1},this.embedSrc="",this.mediaTitle="",this.shouldAutoplayQueue=!1,this.showUpNextQueue=!1,this.showShareButtons=!1,this.showDailymotionLogo=!1,this.showVideoInfo=!0,this.language="en",this.autoplay=!1,this.controls=!1,this.loop=!1,this.muted=!1,this.playsinline=!1,$(this),L(this)}onVideoIdChange(){this.embedSrc=`${this.getOrigin()}/embed/video/${this.videoId}?api=1`,this.internalState=Object.assign({},this.defaultInternalState),this.fetchVideoInfo=this.getVideoInfo(),this.pendingMediaTitleCall=Y()}onControlsChange(){this.internalState.playbackReady&&this.remoteControl("controls",this.controls)}onCustomPosterChange(){this.dispatch("currentPoster",this.poster)}connectedCallback(){this.dispatch=_(this),this.dispatch("viewType",P.Video),this.onVideoIdChange(),this.initialMuted=this.muted,this.internalState.muted=this.muted,this.defaultInternalState=Object.assign({},this.internalState)}getOrigin(){return"https://www.dailymotion.com"}getPreconnections(){return[this.getOrigin(),"https://static1.dmcdn.net"]}remoteControl(t,i){return this.embed.postMessage({command:t,parameters:i?[i]:[]})}buildParams(){return{autoplay:this.autoplay,mute:this.initialMuted,"queue-autoplay-next":this.shouldAutoplayQueue,"queue-enable":this.showUpNextQueue,"sharing-enable":this.showShareButtons,syndication:this.syndication,"ui-highlight":this.color,"ui-logo":this.showDailymotionLogo,"ui-start-screen-info":this.showVideoInfo}}async getVideoInfo(){return G.has(this.videoId)?G.get(this.videoId):window.fetch(`https://api.dailymotion.com/video/${this.videoId}?fields=duration,thumbnail_1080_url`).then((t=>t.json())).then((t=>{const i=t.thumbnail_1080_url,s=parseFloat(t.duration);return G.set(this.videoId,{poster:i,duration:s}),{poster:i,duration:s}}))}onEmbedSrcChange(){this.vLoadStart.emit()}onEmbedMessage(t){var i,s;const e=t.detail;switch(e.event){case"playback_ready":this.onControlsChange(),this.dispatch("currentSrc",this.embedSrc),this.dispatch("mediaType",T.Video),Promise.all([this.fetchVideoInfo,null===(i=this.pendingMediaTitleCall)||void 0===i?void 0:i.promise]).then((([t,i])=>{var s,e;this.dispatch("duration",null!==(s=null==t?void 0:t.duration)&&void 0!==s?s:-1),this.dispatch("currentPoster",null!==(e=this.poster)&&void 0!==e?e:null==t?void 0:t.poster),this.dispatch("mediaTitle",i),this.dispatch("playbackReady",!0)}));break;case"videochange":null===(s=this.pendingMediaTitleCall)||void 0===s||s.resolve(e.title);break;case"start":this.dispatch("paused",!1),this.dispatch("playbackStarted",!0),this.dispatch("buffering",!0);break;case"video_start":this.remoteControl("muted",this.internalState.muted),this.remoteControl("volume",this.internalState.volume),this.internalState.currentTime>0&&this.remoteControl("seek",this.internalState.currentTime);break;case"play":this.dispatch("paused",!1);break;case"pause":this.dispatch("paused",!0),this.dispatch("playing",!1),this.dispatch("buffering",!1);break;case"playing":this.dispatch("playing",!0),this.dispatch("buffering",!1);break;case"video_end":this.loop?setTimeout((()=>{this.remoteControl("play")}),300):this.dispatch("playbackEnded",!0);break;case"timeupdate":this.dispatch("currentTime",parseFloat(e.time));break;case"volumechange":this.dispatch("muted","true"===e.muted),this.dispatch("volume",Math.floor(100*parseFloat(e.volume)));break;case"seeking":this.dispatch("currentTime",parseFloat(e.time)),this.dispatch("seeking",!0);break;case"seeked":this.dispatch("currentTime",parseFloat(e.time)),this.dispatch("seeking",!1);break;case"waiting":this.dispatch("buffering",!0);break;case"progress":this.dispatch("buffered",parseFloat(e.time));break;case"durationchange":this.dispatch("duration",parseFloat(e.duration));break;case"qualitiesavailable":this.dispatch("playbackQualities",e.qualities.map((t=>t+"p")));break;case"qualitychange":this.dispatch("playbackQuality",e.quality+"p");break;case"fullscreenchange":this.dispatch("isFullscreenActive","true"===e.fullscreen);break;case"error":this.dispatch("errors",[new Error(e.error)])}}async getAdapter(){const t=/(?:dai\.ly|dailymotion|dailymotion\.com)\/(?:video\/|embed\/|)(?:video\/|)((?:\w)+)/;return{getInternalPlayer:async()=>this.embed,play:async()=>{this.remoteControl("play")},pause:async()=>{this.remoteControl("pause")},canPlay:async i=>d(i)&&t.test(i),setCurrentTime:async t=>{this.internalState.currentTime=t,this.remoteControl("seek",t)},setMuted:async t=>{this.internalState.muted=t,this.remoteControl("muted",t)},setVolume:async t=>{this.internalState.volume=t/100,this.dispatch("volume",t),this.remoteControl("volume",t/100)},canSetPlaybackQuality:async()=>!0,setPlaybackQuality:async t=>{this.remoteControl("quality",t.slice(0,-1))},canSetFullscreen:async()=>!0,enterFullscreen:async()=>{this.remoteControl("fullscreen",!0)},exitFullscreen:async()=>{this.remoteControl("fullscreen",!1)}}}render(){return e("vime-embed",{embedSrc:this.embedSrc,mediaTitle:this.mediaTitle,origin:this.getOrigin(),params:this.buildParams(),decoder:x,preconnections:this.getPreconnections(),onVEmbedMessage:this.onEmbedMessage.bind(this),onVEmbedSrcChange:this.onEmbedSrcChange.bind(this),ref:t=>{this.embed=t}})}static get watchers(){return{videoId:["onVideoIdChange"],controls:["onControlsChange"],poster:["onCustomPosterChange"]}}},K=class{constructor(t){s(this,t),this.vLoadStart=h(this,"vLoadStart",7),this.hasAttached=!1,this.version="latest",this.config={},this.autoplay=!1,this.preload="metadata",$(this),C(this,["autoplay"])}onSrcChange(){this.hasAttached&&(this.vLoadStart.emit(),this.dash.attachSource(this.src))}connectedCallback(){this.dispatch=_(this),this.mediaEl&&this.setupDash()}disconnectedCallback(){this.destroyDash()}async setupDash(){try{const t=`https://cdn.jsdelivr.net/npm/dashjs@${this.version}/dist/dash.all.min.js`,i=await F(t,"dashjs");this.dash=i.MediaPlayer(this.config).create(),this.dash.initialize(this.mediaEl,null,this.autoplay),this.dash.on(i.MediaPlayer.events.CAN_PLAY,(()=>{this.dispatch("mediaType",T.Video),this.dispatch("currentSrc",this.src),this.dispatch("playbackReady",!0)})),this.dash.on(i.MediaPlayer.events.ERROR,(t=>{this.dispatch("errors",[t])})),this.hasAttached=!0}catch(t){this.dispatch("errors",[t])}}async destroyDash(){var t;null===(t=this.dash)||void 0===t||t.reset(),this.hasAttached=!1}async onMediaElChange(t){this.destroyDash(),v(t.detail)||(this.mediaEl=t.detail,await this.setupDash())}async getAdapter(){const t=await this.videoProvider.getAdapter(),i=t.canPlay;return Object.assign(Object.assign({},t),{getInternalPlayer:async()=>this.dash,canPlay:async t=>d(t)&&Q.test(t)||i(t)})}render(){return e("vime-video",{willAttach:!0,crossOrigin:this.crossOrigin,preload:this.preload,poster:this.poster,controlsList:this.controlsList,autoPiP:this.autoPiP,disablePiP:this.disablePiP,disableRemotePlayback:this.disableRemotePlayback,mediaTitle:this.mediaTitle,ref:t=>{this.videoProvider=t}})}static get watchers(){return{src:["onSrcChange"],hasAttached:["onSrcChange"]}}},X=class{constructor(t){s(this,t),this.noIcons=!1,this.noClickToPlay=!1,this.noDblClickFullscreen=!1,this.noCaptions=!1,this.noPoster=!1,this.noSpinner=!1,this.noControls=!1,this.noSettings=!1,this.noSkeleton=!1}render(){return e("vime-ui",null,!this.noIcons&&e("vime-icons",null),!this.noSkeleton&&e("vime-skeleton",null),!this.noClickToPlay&&e("vime-click-to-play",null),!this.noDblClickFullscreen&&e("vime-dbl-click-fullscreen",null),!this.noCaptions&&e("vime-captions",null),!this.noPoster&&e("vime-poster",null),!this.noSpinner&&e("vime-spinner",null),!this.noControls&&e("vime-default-controls",null),!this.noSettings&&e("vime-default-settings",null),e("slot",null))}},Z=class{constructor(t){s(this,t),this.vLoadStart=h(this,"vLoadStart",7),this.hasAttached=!1,this.version="latest",this.preload="metadata",$(this)}connectedCallback(){this.dispatch=_(this),this.mediaEl&&this.setupHls()}disconnectedCallback(){this.destroyHls()}get src(){if(m(this.videoProvider))return;const t=this.videoProvider.querySelectorAll("source"),i=Array.from(t).find((t=>D.test(t.src)||q.test(t.type)));return null==i?void 0:i.src}async setupHls(){if(v(this.hls)&&!S())try{const t="https://cdn.jsdelivr.net/npm/hls.js@"+this.version,i=await F(t,"Hls");if(!i.isSupported())return void this.dispatch("errors",[new Error("hls.js is not supported")]);this.hls=new i(this.config),this.hls.on(i.Events.MEDIA_ATTACHED,(()=>{this.hasAttached=!0,this.onSrcChange()})),this.hls.on(i.Events.ERROR,((t,s)=>{if(s.fatal)switch(s.type){case i.ErrorTypes.NETWORK_ERROR:this.hls.startLoad();break;case i.ErrorTypes.MEDIA_ERROR:this.hls.recoverMediaError();break;default:this.destroyHls()}this.dispatch("errors",[{e:t,data:s}])})),this.hls.on(i.Events.MANIFEST_PARSED,(()=>{this.dispatch("mediaType",T.Video),this.dispatch("currentSrc",this.src),this.dispatch("playbackReady",!0)})),this.hls.attachMedia(this.mediaEl)}catch(t){this.dispatch("errors",[t])}}destroyHls(){var t;null===(t=this.hls)||void 0===t||t.destroy(),this.hasAttached=!1}async onMediaElChange(t){this.destroyHls(),v(t.detail)||(this.mediaEl=t.detail,setTimeout((async()=>{await this.setupHls()}),50))}async onSrcChange(){this.hasAttached&&this.hls.url!==this.src&&(this.vLoadStart.emit(),this.hls.loadSource(this.src))}async getAdapter(){const t=await this.videoProvider.getAdapter(),i=t.canPlay;return Object.assign(Object.assign({},t),{getInternalPlayer:async()=>this.hls,canPlay:async t=>d(t)&&D.test(t)||i(t)})}render(){return e("vime-video",{willAttach:!S(),crossOrigin:this.crossOrigin,preload:this.preload,poster:this.poster,controlsList:this.controlsList,autoPiP:this.autoPiP,disablePiP:this.disablePiP,disableRemotePlayback:this.disableRemotePlayback,mediaTitle:this.mediaTitle,ref:t=>{this.videoProvider=t}},e("slot",null))}},tt=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]];class it{constructor(t,i){this.el=t,this.listener=i,this.disposal=new B,this.api=(()=>{const t={prefixed:!1},i=tt[0];let s;for(let t=0;t<tt.length;t+=1)if(tt[t][1]in document){s=tt[t];break}if(s){for(let e=0;e<s.length;e+=1)t[i[e]]=s[e];t.prefixed=s[0]!==i[0]}return t})(),this.isSupported&&(this.disposal.add(y(document,this.api.fullscreenchange,this.onFullscreenChange.bind(this))),document.webkitExitFullscreen&&this.disposal.add(y(document,"webkitfullscreenchange",this.onFullscreenChange.bind(this))),document.mozCancelFullScreen&&this.disposal.add(y(document,"mozfullscreenchange",this.onFullscreenChange.bind(this))))}async enterFullscreen(t){if(!this.isSupported)throw Error("Fullscreen API is not available.");return this.el[this.api.requestFullscreen](t)}async exitFullscreen(){if(!this.isSupported)throw Error("Fullscreen API is not available.");if(!this.isActive)throw Error("Player is not currently in fullscreen mode to exit.");return document[this.api.exitFullscreen]()}get isActive(){if(!this.isSupported)return!1;const t=document[this.api.fullscreenElement];return this.el===t||this.el.matches(":"+this.api.fullscreen)||this.el.contains(t)}get isSupported(){return!v(this.api.requestFullscreen)}onFullscreenChange(){this.listener(this.isActive)}destroy(){this.disposal.empty()}}let st=[];class et{constructor(t){this.player=t,st.push(t)}willPlay(){st.forEach((t=>{try{t!==this.player&&t.autopause&&(t.paused=!0)}catch(t){}}))}destroy(){st=st.filter((t=>t!==this.player))}}class ht{constructor(){this.silent=!1}log(...t){this.silent||v(console)||console.log("[Vime tip]:",...t)}warn(...t){this.silent||v(console)||console.error("[Vime warn]:",...t)}}let at=0;const nt=new Set(["currentTime","paused"]),rt=class{constructor(t){s(this,t),this.vThemeChange=h(this,"vThemeChange",7),this.vPausedChange=h(this,"vPausedChange",7),this.vPlay=h(this,"vPlay",7),this.vPlayingChange=h(this,"vPlayingChange",7),this.vSeekingChange=h(this,"vSeekingChange",7),this.vSeeked=h(this,"vSeeked",7),this.vBufferingChange=h(this,"vBufferingChange",7),this.vDurationChange=h(this,"vDurationChange",7),this.vCurrentTimeChange=h(this,"vCurrentTimeChange",7),this.vAttachedChange=h(this,"vAttachedChange",7),this.vReady=h(this,"vReady",7),this.vPlaybackReady=h(this,"vPlaybackReady",7),this.vPlaybackStarted=h(this,"vPlaybackStarted",7),this.vPlaybackEnded=h(this,"vPlaybackEnded",7),this.vBufferedChange=h(this,"vBufferedChange",7),this.vCurrentCaptionChange=h(this,"vCurrentCaptionChange",7),this.vTextTracksChange=h(this,"vTextTracksChange",7),this.vErrorsChange=h(this,"vErrorsChange",7),this.vLoadStart=h(this,"vLoadStart",7),this.vCurrentProviderChange=h(this,"vCurrentProviderChange",7),this.vCurrentSrcChange=h(this,"vCurrentSrcChange",7),this.vCurrentPosterChange=h(this,"vCurrentPosterChange",7),this.vMediaTitleChange=h(this,"vMediaTitleChange",7),this.vControlsChange=h(this,"vControlsChange",7),this.vPlaybackRateChange=h(this,"vPlaybackRateChange",7),this.vPlaybackRatesChange=h(this,"vPlaybackRatesChange",7),this.vPlaybackQualityChange=h(this,"vPlaybackQualityChange",7),this.vPlaybackQualitiesChange=h(this,"vPlaybackQualitiesChange",7),this.vMutedChange=h(this,"vMutedChange",7),this.vVolumeChange=h(this,"vVolumeChange",7),this.vViewTypeChange=h(this,"vViewTypeChange",7),this.vMediaTypeChange=h(this,"vMediaTypeChange",7),this.vLiveChange=h(this,"vLiveChange",7),this.vTouchChange=h(this,"vTouchChange",7),this.vLanguageChange=h(this,"vLanguageChange",7),this.vI18nChange=h(this,"vI18nChange",7),this.vTranslationsChange=h(this,"vTranslationsChange",7),this.vLanguagesChange=h(this,"vLanguagesChange",7),this.vFullscreenChange=h(this,"vFullscreenChange",7),this.vPiPChange=h(this,"vPiPChange",7),this.disposal=new B,this.cache=new Map,this.providerCache=new Map,this.adapterCalls=[],this.shouldCheckForProviderChange=!1,this.attached=!1,this.logger=new ht,this.paused=!0,this.playing=!1,this.duration=-1,this.currentTime=0,this.autoplay=!1,this.ready=!1,this.playbackReady=!1,this.loop=!1,this.muted=!1,this.buffered=0,this.playbackRate=1,this.lastRateCheck=1,this.playbackRates=[1],this.playbackQualities=[],this.seeking=!1,this.debug=!1,this.playbackStarted=!1,this.playbackEnded=!1,this.buffering=!1,this.controls=!1,this.isControlsActive=!1,this.errors=[],this.isCaptionsActive=!1,this.isSettingsActive=!1,this.volume=50,this.isFullscreenActive=!1,this.aspectRatio="16:9",this.isAudioView=!1,this.isVideoView=!1,this.isAudio=!1,this.isVideo=!1,this.isLive=!1,this.isMobile=E,this.isTouch=!1,this.isPiPActive=!1,this.autopause=!0,this.playsinline=!1,this.language="en",this.translations={en:r},this.languages=["en"],this.i18n=r,this.hasMediaChanged=!1}onPausedChange(){this.paused?this.playing=!1:this.autopauseMgr.willPlay(),this.safeAdapterCall("paused",this.paused?"pause":"play")}onDurationChange(){this.isLive=this.duration===1/0}onCurrentTimeChange(){this.currentTime=Math.max(0,Math.min(this.currentTime,this.playbackReady?this.duration:1/0)),this.safeAdapterCall("currentTime","setCurrentTime")}onPlaybackReadyChange(){this.ready||(this.ready=!0)}onMutedChange(){this.safeAdapterCall("muted","setMuted")}async onPlaybackRateChange(t,i){var s,e;if(t!==this.lastRateCheck){if(!await(null===(e=null===(s=this.adapter)||void 0===s?void 0:s.canSetPlaybackRate)||void 0===e?void 0:e.call(s)))return this.logger.log("provider cannot change `playbackRate`."),this.lastRateCheck=i,void(this.playbackRate=i);if(!this.playbackRates.includes(t))return this.logger.log(`invalid \`playbackRate\` of ${t}, valid values are [${this.playbackRates.join(", ")}]`),this.lastRateCheck=i,void(this.playbackRate=i);this.lastRateCheck=t,this.safeAdapterCall("playbackRate","setPlaybackRate")}}async onPlaybackQualityChange(t,i){var s,e;if(!v(t)&&t!==this.lastQualityCheck){if(!await(null===(e=null===(s=this.adapter)||void 0===s?void 0:s.canSetPlaybackQuality)||void 0===e?void 0:e.call(s)))return this.logger.log("provider cannot change `playbackQuality`."),this.lastQualityCheck=i,void(this.playbackQuality=i);if(!this.playbackQualities.includes(t))return this.logger.log(`invalid \`playbackQuality\` of ${t}, valid values are [${this.playbackQualities.join(", ")}]`),this.lastQualityCheck=i,void(this.playbackQuality=i);this.lastQualityCheck=t,this.safeAdapterCall("playbackQuality","setPlaybackQuality")}}onDebugChange(){this.logger.silent=!this.debug}onErrorsChange(t,i){i.length>0&&this.errors.unshift(i),this.logger.warn(this.errors[this.errors.length-1])}onTextTracksChange(){var t;if(v(this.textTracks))return null===(t=this.textTracksChangeListener)||void 0===t||t.call(this),this.currentCaption=void 0,void(this.isCaptionsActive=!1);this.onActiveCaptionChange(),this.textTracksChangeListener=y(this.textTracks,"change",this.onActiveCaptionChange.bind(this))}async onVolumeChange(){this.volume=Math.max(0,Math.min(this.volume,100)),this.safeAdapterCall("volume","setVolume")}onViewTypeChange(){this.isAudioView=this.viewType===P.Audio,this.isVideoView=this.viewType===P.Video}onMediaTypeChange(){this.isAudio=this.mediaType===T.Audio,this.isVideo=this.mediaType===T.Video}onLanguageChange(t,i){if(!this.languages.includes(this.language))return this.logger.log(`invalid \`language\` of ${this.language}, valid values are [${this.languages.join(", ")}]`),void(this.language=i);this.i18n=this.translations[this.language]}onTranslationsChange(){Object.assign(this.translations,{en:r}),this.languages=Object.keys(this.translations),this.i18n=this.translations[this.language]}async getProvider(){return this.provider}async setProvider(t){this.provider=t,this.adapter=await this.provider.getAdapter()}async getAdapter(){return this.adapter}async play(){var t;return null===(t=this.adapter)||void 0===t?void 0:t.play()}async pause(){var t;return null===(t=this.adapter)||void 0===t?void 0:t.pause()}async canPlay(t){var i,s;return null!==(s=null===(i=this.adapter)||void 0===i?void 0:i.canPlay(t))&&void 0!==s&&s}async canAutoplay(){return j()}async canMutedAutoplay(){return j(!0)}async canSetPlaybackRate(){var t,i,s;return null!==(s=null===(i=null===(t=this.adapter)||void 0===t?void 0:t.canSetPlaybackRate)||void 0===i?void 0:i.call(t))&&void 0!==s&&s}async canSetPlaybackQuality(){var t,i,s;return null!==(s=null===(i=null===(t=this.adapter)||void 0===t?void 0:t.canSetPlaybackQuality)||void 0===i?void 0:i.call(t))&&void 0!==s&&s}async canSetFullscreen(){var t,i,s;return this.fullscreen.isSupported||null!==(s=null===(i=null===(t=this.adapter)||void 0===t?void 0:t.canSetFullscreen)||void 0===i?void 0:i.call(t))&&void 0!==s&&s}async enterFullscreen(t){var i,s,e,h;if(!this.isVideoView)throw Error("Cannot enter fullscreen on an audio player view.");if(this.fullscreen.isSupported)return this.fullscreen.enterFullscreen(t);if(await(null===(s=null===(i=this.adapter)||void 0===i?void 0:i.canSetFullscreen)||void 0===s?void 0:s.call(i)))return null===(h=null===(e=this.adapter)||void 0===e?void 0:e.enterFullscreen)||void 0===h?void 0:h.call(e,t);throw Error("Fullscreen API is not available.")}async exitFullscreen(){var t,i;return this.fullscreen.isSupported?this.fullscreen.exitFullscreen():null===(i=null===(t=this.adapter)||void 0===t?void 0:t.exitFullscreen)||void 0===i?void 0:i.call(t)}async canSetPiP(){var t,i,s;return null!==(s=null===(i=null===(t=this.adapter)||void 0===t?void 0:t.canSetPiP)||void 0===i?void 0:i.call(t))&&void 0!==s&&s}async enterPiP(){var t,i;if(!this.isVideoView)throw Error("Cannot enter PiP mode on an audio player view.");if(!await this.canSetPiP())throw Error("Picture-in-Picture API is not available.");return null===(i=null===(t=this.adapter)||void 0===t?void 0:t.enterPiP)||void 0===i?void 0:i.call(t)}async exitPiP(){var t,i;return null===(i=null===(t=this.adapter)||void 0===t?void 0:t.exitPiP)||void 0===i?void 0:i.call(t)}async extendLanguage(t,i){var s;const e=Object.assign(Object.assign({},this.translations),{[t]:Object.assign(Object.assign({},null!==(s=this.translations[t])&&void 0!==s?s:{}),i)});this.translations=e}onMediaProviderConnect(i){var s;i.stopImmediatePropagation();const e=t(i.detail);if(this.provider===e)return;const h=null===(s=e)||void 0===s?void 0:s.nodeName.toLowerCase().replace("vime-","");a((async()=>{var t;await this.onMediaProviderDisconnect(),this.provider=e,this.adapter=await(null===(t=this.provider)||void 0===t?void 0:t.getAdapter()),this.currentProvider=Object.values(I).find((t=>h===t))}))}onMediaProviderDisconnect(t){null==t||t.stopImmediatePropagation(),a((async()=>{this.ready=!1,this.provider=void 0,this.adapter=void 0,await this.onMediaChange()}))}async onMediaChange(t){null==t||t.stopPropagation(),this.hasMediaChanged?(this.adapterCalls=[],this.providerCache.clear(),a((()=>{Object.keys(o).filter(l).forEach((t=>{this[t]=o[t]}))}))):this.hasMediaChanged=!0}async onStateChange(t){var i,s,e;t.stopImmediatePropagation();const{by:h,prop:n,value:r}=t.detail;c(n)?(!this.playbackStarted&&nt.has(n)&&("paused"!==n||r||null===(i=this.adapter)||void 0===i||i.play(),"currentTime"===n&&(null===(s=this.adapter)||void 0===s||s.play(),null===(e=this.adapter)||void 0===e||e.setCurrentTime(r))),a((()=>{this[n]=r}))):this.logger.warn(`${h.nodeName} tried to change \`${n}\` but it is readonly.`)}onProviderChange(t){t.stopImmediatePropagation();const{by:i,prop:s,value:e}=t.detail;u(s)?a((()=>{this.providerCache.set(s,e),this[s]=e})):this.logger.warn(`${i.nodeName} tried to change \`${s}\` but it is readonly.`)}connectedCallback(){const t=this.getPlayerState();Object.keys(t).forEach((i=>{this.cache.set(i,t[i]),this.providerCache.set(i,o[i])})),this.autopauseMgr=new et(this.el),this.onPausedChange(),this.onCurrentTimeChange(),this.onVolumeChange(),this.onMutedChange(),this.onDebugChange(),this.onTranslationsChange(),this.onLanguageChange(this.language,o.language),this.fullscreen=new it(this.el,(t=>{this.isFullscreenActive=t,this.rotateDevice()})),this.disposal.add(V((t=>{this.isTouch=t}))),this.attached=!0}componentWillLoad(){!function(i,s){var e=t(i),h=new Map,a={wormholes:h,state:s};H.set(i,a);var n=i.connectedCallback;i.connectedCallback=function(){H.set(i,a),n&&n.call(i)};var r=i.disconnectedCallback;i.disconnectedCallback=function(){H.delete(i),r&&r.call(i)},e.addEventListener("openWormhole",(function(t){t.stopPropagation();var i=t.detail,s=i.consumer,e=i.onOpen;if(!h.has(s)){if("symbol"!=typeof s){var n=s.connectedCallback,r=s.disconnectedCallback;s.connectedCallback=function(){h.set(s,t.detail),n&&n.call(s)},s.disconnectedCallback=function(){h.delete(s),r&&r.call(s)}}h.set(s,t.detail),U(t.detail,a.state),null==e||e.resolve((function(){h.delete(s)}))}})),e.addEventListener("closeWormhole",(function(t){h.delete(t.detail)}))}(this,this.getPlayerState())}componentWillRender(){return this.playbackReady?this.flushAdapterCalls():void 0}async componentDidRender(){const t=Array.from(this.cache.keys());for(let i=0;i<t.length;i+=1){const s=t[i],e=this.cache.get(s),h=this[s];e!==h&&(this.fireEvent(s,h,e),this.cache.set(s,h))}}disconnectedCallback(){var t;this.adapterCalls=[],this.hasMediaChanged=!1,null===(t=this.textTracksChangeListener)||void 0===t||t.call(this),this.fullscreen.destroy(),this.autopauseMgr.destroy(),this.disposal.empty(),this.attached=!1,this.shouldCheckForProviderChange=!0}async rotateDevice(){if(E&&M())try{this.isFullscreenActive?await window.screen.orientation.lock("landscape"):await window.screen.orientation.unlock()}catch(t){this.errors=[t]}}getPlayerState(){return Object.keys(o).reduce(((t,i)=>Object.assign(Object.assign({},t),{[i]:this[i]})),{})}calcAspectRatio(){const[t,i]=/\d{1,2}:\d{1,2}/.test(this.aspectRatio)?this.aspectRatio.split(":"):[16,9];return 100/Number(t)*Number(i)}async callAdapter(t,i){return this.adapter[t](i)}async toggleCaptionsVisibility(t){const i=null!=t?t:!this.isCaptionsActive;if(v(this.textTracks)||i&&v(this.toggledCaption)||!i&&v(this.getActiveCaption()))return;if(i)return this.toggledCaption.mode="showing",void(this.toggledCaption=void 0);const s=this.getActiveCaption();this.toggledCaption=s,s.mode=this.hasCustomCaptions()?"disabled":"hidden"}hasCustomControls(){return!p(this.el.querySelector("vime-ui vime-controls"))}hasCustomCaptions(){return!p(this.el.querySelector("vime-ui vime-captions"))}getActiveCaption(){var t;return Array.from(null!==(t=this.textTracks)&&void 0!==t?t:[]).filter((t=>"subtitles"===t.kind||"captions"===t.kind)).find((t=>t.mode===(this.hasCustomCaptions()?"hidden":"showing")))}onActiveCaptionChange(){const t=this.getActiveCaption();this.currentCaption=t||this.toggledCaption,this.isCaptionsActive=!v(t)}isAdapterCallRequired(t,i){return i!==this.providerCache.get(t)}async safeAdapterCall(t,i){if(!this.isAdapterCallRequired(t,this[t]))return;const s=this[t],e=async t=>{var e;try{await(null===(e=null==t?void 0:t[i])||void 0===e?void 0:e.call(t,s))}catch(t){this.errors=[t]}};this.playbackReady?await e(this.adapter):this.adapterCalls.push(e)}async flushAdapterCalls(){if(!v(this.adapter)){for(let t=0;t<this.adapterCalls.length;t+=1)await this.adapterCalls[t](this.adapter);this.adapterCalls=[]}}fireEvent(t,i,s){const e=[];e.push(new CustomEvent(w(t),{bubbles:!1,detail:i})),"paused"!==t||i||e.push(new CustomEvent("vPlay",{bubbles:!1})),"seeking"===t&&s&&!i&&e.push(new CustomEvent("vSeeked",{bubbles:!1})),e.forEach((t=>{this.el.dispatchEvent(t)}))}genId(){var t;const i=null===(t=this.el)||void 0===t?void 0:t.id;return d(i)&&i.length>0?i:(at+=1,"vime-player-"+at)}render(){const t=(this.isAudioView?"Audio Player":"Video Player")+(v(this.mediaTitle)?"":" - "+this.mediaTitle),i=!R||!this.isVideoView||this.playsinline&&!this.isFullscreenActive;return i||(this.controls=!0),e(n,{id:this.genId(),tabindex:"0","aria-label":t,"aria-hidden":this.ready?"false":"true","aria-busy":this.playbackReady?"false":"true",style:{paddingBottom:this.isVideoView?this.calcAspectRatio()+"%":void 0},class:{idle:i&&this.hasCustomControls()&&this.isVideoView&&!this.paused&&!this.isControlsActive,mobile:this.isMobile,touch:this.isTouch,audio:this.isAudioView,video:this.isVideoView,fullscreen:this.isFullscreenActive}},!this.controls&&i&&this.isVideoView&&e("div",{class:"blocker"}),e(W,{state:this.getPlayerState()},e("slot",null)))}get el(){return t(this)}static get watchers(){return{paused:["onPausedChange"],duration:["onDurationChange"],currentTime:["onCurrentTimeChange"],playbackReady:["onPlaybackReadyChange"],muted:["onMutedChange"],playbackRate:["onPlaybackRateChange"],playbackQuality:["onPlaybackQualityChange"],debug:["onDebugChange"],errors:["onErrorsChange"],textTracks:["onTextTracksChange"],volume:["onVolumeChange"],viewType:["onViewTypeChange"],isAudioView:["onViewTypeChange"],isVideoView:["onViewTypeChange"],mediaType:["onMediaTypeChange"],language:["onLanguageChange"],translations:["onTranslationsChange"]}}};var ot;rt.style="vime-player{box-sizing:border-box;direction:ltr;font-family:var(--vm-player-font-family);-moz-osx-font-smoothing:auto;-webkit-font-smoothing:subpixel-antialiased;-webkit-tap-highlight-color:transparent;font-variant-numeric:tabular-nums;font-weight:500;line-height:1.7;width:100%;display:block;max-width:100%;min-width:275px;min-height:40px;position:relative;text-shadow:none;outline:0;transition:box-shadow 0.3s ease;box-shadow:var(--vm-player-box-shadow)}vime-player.idle{cursor:none}vime-player.audio{background-color:transparent !important}vime-player.video{height:0;overflow:hidden;background-color:var(--vm-player-bg, #000)}vime-player.fullscreen{margin:0;border-radius:0;width:100%;height:100%;padding-bottom:0 !important}vime-player *,vime-player *::after,vime-player *::before{box-sizing:inherit}vime-player button{font:inherit;line-height:inherit;width:auto;margin:0}vime-player button::-moz-focus-inner{border:0}vime-player a,vime-player button,vime-player input,vime-player label{touch-action:manipulation}vime-player .blocker{position:absolute;top:0;left:0;width:100%;height:100%;z-index:var(--vm-blocker-z-index);display:inline-block}",function(t){t.Play="play",t.Pause="pause",t.Seeking="seeking",t.Seeked="seeked",t.TimeUpdate="timeupdate",t.VolumeChange="volumechange",t.DurationChange="durationchange",t.FullscreenChange="fullscreenchange",t.CueChange="cuechange",t.Progress="progress",t.Error="error",t.PlaybackRateChange="playbackratechange",t.Loaded="loaded",t.BufferStart="bufferstart",t.BufferEnd="bufferend",t.TextTrackChange="texttrackchange",t.Waiting="waiting",t.Ended="ended"}(ot||(ot={}));const lt=new Map,ct=class{constructor(t){s(this,t),this.vLoadStart=h(this,"vLoadStart",7),this.defaultInternalState={},this.volume=50,this.hasLoaded=!1,this.internalState={paused:!0,playing:!1,seeking:!1,currentTime:0,buffered:0,playbackStarted:!1,playRequest:!1},this.embedSrc="",this.mediaTitle="",this.byline=!0,this.portrait=!0,this.noAutoAspectRatio=!1,this.language="en",this.aspectRatio="16:9",this.autoplay=!1,this.controls=!1,this.loop=!1,this.muted=!1,this.playsinline=!1,$(this),L(this)}onVideoIdChange(){this.embedSrc=`${this.getOrigin()}/video/${this.videoId}`,this.cancelTimeUpdates(),this.pendingDurationCall=Y(),this.pendingMediaTitleCall=Y(),this.fetchVideoInfo=this.getVideoInfo()}onCustomPosterChange(){this.dispatch("currentPoster",this.poster)}connectedCallback(){this.dispatch=_(this),this.dispatch("viewType",P.Video),this.onVideoIdChange(),this.initialMuted=this.muted,this.defaultInternalState=Object.assign({},this.internalState)}disconnectedCallback(){this.cancelTimeUpdates(),this.pendingPlayRequest=void 0}getOrigin(){return"https://player.vimeo.com"}getPreconnections(){return[this.getOrigin(),"https://i.vimeocdn.com","https://f.vimeocdn.com","https://fresnel.vimeocdn.com"]}remoteControl(t,i){return this.embed.postMessage({method:t,value:i})}buildParams(){return{byline:this.byline,color:this.color,portrait:this.portrait,autopause:!1,transparent:!1,autoplay:this.autoplay,muted:this.initialMuted,playsinline:this.playsinline}}async getVideoInfo(){return lt.has(this.videoId)?lt.get(this.videoId):window.fetch("https://vimeo.com/api/oembed.json?url="+this.embedSrc).then((t=>t.json())).then((t=>{const i={poster:`https://i.vimeocdn.com/video/${null==t?void 0:t.thumbnail_url.match(/vimeocdn\.com\/video\/([0-9]+)/)[1]}_1920x1080.jpg`,width:null==t?void 0:t.width,height:null==t?void 0:t.height};return lt.set(this.videoId,i),i}))}onTimeChange(t){this.internalState.currentTime!==t&&(this.dispatch("currentTime",t),Math.abs(this.internalState.currentTime-t)>1.5&&(this.internalState.seeking=!0,this.dispatch("seeking",!0),this.internalState.playing&&this.internalState.buffered<t&&this.dispatch("buffering",!0),window.clearTimeout(this.pendingPlayRequest),this.internalState.paused||(this.internalState.playRequest=!0),this.remoteControl(this.internalState.playbackStarted?"pause":"play")),this.internalState.currentTime=t)}cancelTimeUpdates(){b(this.timeRAF)&&window.cancelAnimationFrame(this.timeRAF)}requestTimeUpdates(){this.remoteControl("getCurrentTime"),this.timeRAF=window.requestAnimationFrame((()=>{this.requestTimeUpdates()}))}onSeeked(){this.internalState.seeking&&(this.dispatch("seeking",!1),this.internalState.seeking=!1,this.internalState.playRequest&&window.setTimeout((()=>{this.remoteControl("play")}),150))}onVimeoMethod(t,i){var s,e;switch(t){case"getCurrentTime":this.internalState.seeking||this.onTimeChange(i);break;case"getDuration":null===(s=this.pendingDurationCall)||void 0===s||s.resolve(i);break;case"getVideoTitle":null===(e=this.pendingMediaTitleCall)||void 0===e||e.resolve(i)}}onLoaded(){var t,i;this.hasLoaded||(this.pendingPlayRequest=void 0,this.internalState=Object.assign({},this.defaultInternalState),this.dispatch("currentSrc",this.embedSrc),this.dispatch("mediaType",T.Video),this.remoteControl("getDuration"),this.remoteControl("getVideoTitle"),Promise.all([this.fetchVideoInfo,null===(t=this.pendingDurationCall)||void 0===t?void 0:t.promise,null===(i=this.pendingMediaTitleCall)||void 0===i?void 0:i.promise]).then((([t,i,s])=>{var e,h,a;this.requestTimeUpdates(),this.dispatch("aspectRatio",`${null!==(e=null==t?void 0:t.width)&&void 0!==e?e:16}:${null!==(h=null==t?void 0:t.height)&&void 0!==h?h:9}`),this.dispatch("currentPoster",null!==(a=this.poster)&&void 0!==a?a:null==t?void 0:t.poster),this.dispatch("duration",null!=i?i:-1),this.dispatch("mediaTitle",s),this.dispatch("playbackReady",!0),this.autoplay&&this.remoteControl("play")})),this.hasLoaded=!0)}onVimeoEvent(t,i){switch(t){case"ready":Object.values(ot).forEach((t=>{this.remoteControl("addEventListener",t)}));break;case"loaded":this.onLoaded();break;case"play":this.onLoaded(),this.internalState.paused=!1,this.dispatch("paused",!1);break;case"playProgress":this.internalState.playing||(this.dispatch("playing",!0),this.internalState.playing=!0,this.internalState.playbackStarted=!0,this.pendingPlayRequest=window.setTimeout((()=>{this.internalState.playRequest=!1,this.pendingPlayRequest=void 0}),1e3)),this.dispatch("buffering",!1),this.onSeeked();break;case"pause":this.internalState.paused=!0,this.internalState.playing=!1,this.dispatch("paused",!0),this.dispatch("buffering",!1);break;case"loadProgress":this.internalState.buffered=i.seconds,this.dispatch("buffered",i.seconds);break;case"bufferstart":this.dispatch("buffering",!0),this.internalState.paused&&(this.internalState.paused=!1,this.dispatch("paused",!1),this.dispatch("playbackStarted",!0));break;case"bufferend":this.dispatch("buffering",!1),this.internalState.paused&&this.onSeeked();break;case"volumechange":if(i.volume>0){const t=Math.floor(100*i.volume);this.dispatch("muted",!1),this.volume!==t&&(this.volume=t,this.dispatch("volume",this.volume))}else this.dispatch("muted",!0);break;case"durationchange":this.dispatch("duration",i.duration);break;case"playbackratechange":this.dispatch("playbackRate",i.playbackRate);break;case"fullscreenchange":this.dispatch("isFullscreenActive",i.fullscreen);break;case"finish":this.loop?(this.remoteControl("setCurrentTime",0),setTimeout((()=>{this.remoteControl("play")}),200)):this.dispatch("playbackEnded",!0);break;case"error":this.dispatch("errors",[new Error(i)])}}onEmbedSrcChange(){this.hasLoaded=!1,this.vLoadStart.emit()}onEmbedMessage(t){const i=t.detail;v(i.event)||this.onVimeoEvent(i.event,i.data),v(i.method)||this.onVimeoMethod(i.method,i.value)}adjustPosition(){const[t,i]=this.aspectRatio.split(":").map((t=>parseInt(t,10)));return{paddingBottom:"240%",transform:`translateY(-${(240-100/t*i)/4.8+.02}%)`}}async getAdapter(){const t=/vimeo(?:\.com|)\/([0-9]{9,})/,i=/vimeo\.com\/external\/[0-9]+\..+/;return{getInternalPlayer:async()=>this.embed,play:async()=>{this.remoteControl("play")},pause:async()=>{this.remoteControl("pause")},canPlay:async s=>d(s)&&!i.test(s)&&t.test(s),setCurrentTime:async t=>{this.remoteControl("setCurrentTime",t)},setMuted:async t=>{t||(this.volume=this.volume>0?this.volume:30),this.remoteControl("setVolume",t?0:this.volume/100)},setVolume:async t=>{this.muted?this.dispatch("volume",t):this.remoteControl("setVolume",t/100)},canSetPlaybackRate:async()=>!1,setPlaybackRate:async t=>{this.remoteControl("setPlaybackRate",t)}}}render(){return e("vime-embed",{class:{hideControls:!this.controls},style:this.adjustPosition(),embedSrc:this.embedSrc,mediaTitle:this.mediaTitle,origin:this.getOrigin(),params:this.buildParams(),decoder:A,preconnections:this.getPreconnections(),onVEmbedMessage:this.onEmbedMessage.bind(this),onVEmbedSrcChange:this.onEmbedSrcChange.bind(this),ref:t=>{this.embed=t}})}static get watchers(){return{videoId:["onVideoIdChange"],poster:["onCustomPosterChange"]}}};ct.style="vime-vimeo>vime-embed.hideControls{display:block;width:100%;position:relative;z-index:var(--vm-media-z-index)}";const ut=t=>{switch(t){case"unknown":return;case"tiny":return"144p";case"small":return"240p";case"medium":return"360p";case"large":return"480p";case"hd720":return"720p";case"hd1080":return"1080p";case"highres":return"1440p";case"max":return"2160p";default:return}},dt=new Map,vt=class{constructor(t){s(this,t),this.vLoadStart=h(this,"vLoadStart",7),this.defaultInternalState={},this.hasCued=!1,this.internalState={paused:!0,duration:0,seeking:!1,playbackStarted:!1,currentTime:0,lastTimeUpdate:0,playbackRate:1,state:-1},this.embedSrc="",this.mediaTitle="",this.cookies=!1,this.showFullscreenControl=!0,this.language="en",this.autoplay=!1,this.controls=!1,this.loop=!1,this.muted=!1,this.playsinline=!1,$(this),L(this)}onVideoIdChange(){this.embedSrc=`${this.getOrigin()}/embed/${this.videoId}`,this.fetchPosterURL=this.findPosterURL()}onCustomPosterChange(){this.dispatch("currentPoster",this.poster)}connectedCallback(){this.dispatch=_(this),this.dispatch("viewType",P.Video),this.onVideoIdChange(),this.initialMuted=this.muted,this.defaultInternalState=Object.assign({},this.internalState)}async getAdapter(){const t=/(?:youtu\.be|youtube|youtube\.com|youtube-nocookie\.com)\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=|)((?:\w|-){11})/;return{getInternalPlayer:async()=>this.embed,play:async()=>{this.remoteControl("playVideo")},pause:async()=>{this.remoteControl("pauseVideo")},canPlay:async i=>d(i)&&t.test(i),setCurrentTime:async t=>{this.remoteControl("seekTo",t)},setMuted:async t=>{this.remoteControl(t?"mute":"unMute")},setVolume:async t=>{this.remoteControl("setVolume",t)},canSetPlaybackRate:async()=>!0,setPlaybackRate:async t=>{this.remoteControl("setPlaybackRate",t)}}}getOrigin(){return this.cookies?"https://www.youtube.com":"https://www.youtube-nocookie.com"}getPreconnections(){return[this.getOrigin(),"https://www.google.com","https://googleads.g.doubleclick.net","https://static.doubleclick.net","https://s.ytimg.com","https://i.ytimg.com"]}remoteControl(t,i){return this.embed.postMessage({event:"command",func:t,args:i?[i]:void 0})}buildParams(){return{enablejsapi:1,cc_lang_pref:this.language,hl:this.language,widget_referrer:window.location.href,fs:this.showFullscreenControl?1:0,controls:this.controls?1:0,disablekb:this.controls?0:1,iv_load_policy:this.controls?1:3,mute:this.initialMuted?1:0,playsinline:this.playsinline?1:0,autoplay:this.autoplay?1:0}}onEmbedSrcChange(){this.hasCued=!1,this.vLoadStart.emit()}onEmbedLoaded(){window.setTimeout((()=>this.embed.postMessage({event:"listening"})),100)}async findPosterURL(){if(dt.has(this.videoId))return dt.get(this.videoId);const t=t=>`https://i.ytimg.com/vi/${this.videoId}/${t}.jpg`;return O(t("maxresdefault"),121).catch((()=>O(t("sddefault"),121))).catch((()=>O(t("hqdefault"),121))).then((t=>{const i=t.src;return dt.set(this.videoId,i),i}))}onCued(){this.hasCued||(this.internalState=Object.assign({},this.defaultInternalState),this.dispatch("currentSrc",this.embedSrc),this.dispatch("mediaType",T.Video),this.fetchPosterURL.then((t=>{var i;this.dispatch("currentPoster",null!==(i=this.poster)&&void 0!==i?i:t),this.dispatch("playbackReady",!0),this.autoplay&&this.remoteControl("playVideo")})),this.hasCued=!0)}onPlayerStateChange(t){if(-1===t)return;const i=1===t,s=3===t;switch(this.dispatch("buffering",s),this.internalState.paused&&(s||i)&&(this.internalState.paused=!1,this.dispatch("paused",!1),this.internalState.playbackStarted||(this.dispatch("playbackStarted",!0),this.internalState.playbackStarted=!0)),t){case 5:this.onCued();break;case 1:this.onCued(),this.dispatch("playing",!0);break;case 2:this.internalState.paused=!0,this.dispatch("paused",!0);break;case 0:this.loop?window.setTimeout((()=>{this.remoteControl("playVideo")}),150):(this.dispatch("playbackEnded",!0),this.internalState.paused=!0,this.dispatch("paused",!0))}this.internalState.state=t}calcCurrentTime(t){let i=t;if(0===this.internalState.state)return this.internalState.duration;if(1===this.internalState.state){const t=(Date.now()/1e3-this.defaultInternalState.lastTimeUpdate)*this.internalState.playbackRate;t>0&&(i+=Math.min(t,1))}return i}onTimeChange(t){const i=this.calcCurrentTime(t);this.dispatch("currentTime",i),Math.abs(this.internalState.currentTime-i)>1.5&&(this.internalState.seeking=!0,this.dispatch("seeking",!0)),this.internalState.currentTime=i}onBufferedChange(t){this.dispatch("buffered",t),this.internalState.seeking&&t>this.internalState.currentTime&&window.setTimeout((()=>{this.internalState.seeking=!1,this.dispatch("seeking",!1)}),this.internalState.paused?100:0)}onEmbedMessage(t){const i=t.detail,{info:s}=i;s&&(g(s.videoData)&&this.dispatch("mediaTitle",s.videoData.title),b(s.duration)&&(this.internalState.duration=s.duration,this.dispatch("duration",s.duration)),f(s.availablePlaybackRates)&&this.dispatch("playbackRates",s.availablePlaybackRates),b(s.playbackRate)&&(this.internalState.playbackRate=s.playbackRate,this.dispatch("playbackRate",s.playbackRate)),b(s.currentTime)&&this.onTimeChange(s.currentTime),b(s.currentTimeLastUpdated)&&(this.internalState.lastTimeUpdate=s.currentTimeLastUpdated),b(s.videoLoadedFraction)&&this.onBufferedChange(s.videoLoadedFraction*this.internalState.duration),b(s.volume)&&this.dispatch("volume",s.volume),k(s.muted)&&this.dispatch("muted",s.muted),f(s.availableQualityLevels)&&this.dispatch("playbackQualities",s.availableQualityLevels.map((t=>ut(t)))),d(s.playbackQuality)&&this.dispatch("playbackQuality",ut(s.playbackQuality)),b(s.playerState)&&this.onPlayerStateChange(s.playerState))}render(){return e("vime-embed",{embedSrc:this.embedSrc,mediaTitle:this.mediaTitle,origin:this.getOrigin(),params:this.buildParams(),decoder:A,preconnections:this.getPreconnections(),onVEmbedLoaded:this.onEmbedLoaded.bind(this),onVEmbedMessage:this.onEmbedMessage.bind(this),onVEmbedSrcChange:this.onEmbedSrcChange.bind(this),ref:t=>{this.embed=t}})}static get watchers(){return{cookies:["onVideoIdChange"],videoId:["onVideoIdChange"],poster:["onCustomPosterChange"]}}};export{N as vime_audio,J as vime_dailymotion,K as vime_dash,X as vime_default_ui,Z as vime_hls,rt as vime_player,ct as vime_vimeo,vt as vime_youtube}